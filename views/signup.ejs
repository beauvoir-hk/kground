<div class="container">
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>케이그라운드</title>
        <%- include("header.ejs") %>
<!-- bootstrap 링크 -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>

<!-- jquery 링크 -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<!-- Bootstrap core JavaScript-->
<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

<!-- Core plugin JavaScript-->
<script src="vendor/jquery-easing/jquery.easing.min.js"></script>
<script src="js/sb-admin-2.min.js"></script>


        <style>
            .display{
                display: none;
            }
        </style>
    </head>
    <body class="bg-gradient-primary">
        <div class="container">
        <!-- Outer Row -->
        <div class="row justify-content-center">
            <div class="col-xl-10 col-lg-12 col-md-9">
                <div class="card o-hidden border-0 shadow-lg my-5">
                    <div class="card-body p-0">
                        <!-- Nested Row within Card Body -->
                        <div class="row">
                            <div class="col-lg-6"> 
                                <div class="p-5">
                                    <div class="text-center">
                       <h1 class="h5 text-gray-900 mb-4">케이그라운드 회원 가입 화면</h1>
                                    </div>

                        <!-- 유저가 회원 정보를 입력하는 공간 -->
                        <form action="/user/signup", method="post">
                            <div class="form-group">
                                <input type="text" name="input_phone" id="_id" class="form-control form-control-user" placeholder="Enter your Phone-number..."  >
                            </div>
                            <div align="right">  
                                <span class="small" id="check_id">아이디 중복 체크</span>
                            </div>
                            <div class="form-group">
                                <input type="password" name="input_pass" id="_pass" class="form-control" placeholder="Password"  >
                            </div><br>
                            <div class="form-group">
                                <input type="password" id="_confirm" class="form-control" placeholder="Password"  >
                            </div><br>
                            <div class="form-group">
                                <input type="text" name="input_username" class="form-control" placeholder="user name"  >
                            </div><br>
                            <div class="form-group">
                                <input type="text" name="input_nickname" class="form-control" placeholder="nickname"   >
                            </div><br>
                            <div class="form-group">
                                <input type="text" name="input_refferal" class="form-control" placeholder="추천인을 입력해주세요"  >
                            </div><br>
                            <div class="form-group">
                                <input type="password" name="input_numeric6" class="form-control" placeholder="결제비밀번호(6자리숫자)"  >
                            </div></form>
                            <div class="text-center">  
                                <input  type="submit" value="회원가입" id="signup" disabled>
                            </div>
                        </form>
                            </div>
        </div>  
        <div class="col-lg-5"><img src="/img/001.png"  width="100%" height="100%"></div>   
    </div>
</div>
</div>
</div>
</div>
        
        <script>
            $('#check_id').click(function(){
                const input_id = $('#_id').val()
                // ajax을 이용하여 서버와 비동기 통신
                // 해당하는 id가 데이터베이스에 존재하는가?
                $.ajax(
                    {
                        url : '/check_id',   //비동기 통신을 할 주소값
                        method : 'get', 
                        datatype : 'json', 
                        data : {
                            _id : input_id
                        }
                    }
                )
                .done(function(result){
                    // result : 비동기 통신이 완료한 뒤 서버가 유저에게 보내는 데이터
                    // /check_id에서 id를 체크한 뒤 사용 가능한 아이디면 True
                    // 사용이 불가능한 id라면 false 
                    // true이면 비밀번호, 비밀번호 확인, 이름을 입력할 수 있는 공간을 보여준다.
                    // span 태그를 숨기고 id를 입력하는 부분을 수정 불가능하게 한다. 
                    if(result){
                        // display 라는 class가 display none이기 때문에 
                        // 해당하는 class를 가지고 있지 않다면 화면에 표시
                        $('#info').toggleClass('display')
                        $('#check_id').toggleClass('display')
                        $('#_id').attr('readonly', 'true')
                    }
                })
            })
    
            // 패스워드와 확인 패스워드가 같아야지만 회원가입 버튼이 활성화
            // 태그의 id가 _confirm이 입력이 될때마다 _pass와 값을 비교하여 
            // 같은 경우에 회원가입 버튼을 활성화
            $('#_confirm').keyup(function(){
                const password = $('#_pass').val()
                const confirm = $('#_confirm').val()
                if(password == confirm){
                    $('#signup').removeAttr('disabled')
                }else{
                    $('#signup').attr('disabled', 'true')
                }
            })
        </script>
    </body>
    </html>